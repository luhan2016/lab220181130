working version with comment and remove prints
