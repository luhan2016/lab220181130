working version 5 with coordinate message aggrement and lower cost
